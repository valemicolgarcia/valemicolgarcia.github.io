---
layout: default
title: Heart Disease Prediction
---

<section class="project-detail-section">
  <div class="project-header">
    <a href="/roadmap.html" class="back-link"><i class="fas fa-arrow-left"></i> Back to Roadmap</a>
    <h1 class="project-detail-title">Heart Disease Prediction</h1>
    <p class="project-detail-subtitle">Supervised Machine Learning</p>
    <div class="project-tags">
      <span class="tag">Scikit-learn</span>
      <span class="tag">Random Forest</span>
      <span class="tag">XGBoost</span>
      <span class="tag">Logistic Regression</span>
      <span class="tag">Decision Tree</span>
    </div>
    <div class="github-link">
      <a href="https://github.com/valemicolgarcia/valemicolgarcia.github.io/blob/main/projects/heart-disease-data/EntregaFinal-ValeriaMicolGarcia.ipynb" target="_blank" class="github-btn">
        <i class="fab fa-github"></i> Ver código en GitHub
      </a>
    </div>
  </div>

  <div class="project-content">
    <div class="project-overview">
      <h2>Problem to Solve</h2>
      <p>Cardiovascular diseases are the leading cause of death worldwide, responsible for the loss of millions of lives each year. This project seeks to detect and predict the determining variables that put us at risk of heart disease, allowing awareness and preventive measures.</p>
      <p>The objective is to identify which risk factors (age, blood pressure, cholesterol, lifestyle habits, etc.) have the greatest impact on the probability of developing heart disease, using advanced machine learning techniques to create a robust predictive model.</p>
    </div>

    <div class="dataset-section">
      <h2>1. Dataset Information</h2>
      <p class="section-description">Two complementary datasets were used that contain information about cardiovascular risk factors and patient health conditions.</p>
      
      <div class="datasets-info">
        <div class="dataset-card">
          <h3>Dataset 1: HEARTDISEASE</h3>
          <p class="dataset-size"><strong>Tamaño:</strong> 3,674 filas × 16 columnas</p>
          <div class="variables-list-compact">
            <ul>
              <li><strong>sex:</strong> Male or female gender</li>
              <li><strong>age:</strong> Person's age</li>
              <li><strong>education:</strong> Education level</li>
              <li><strong>smokingStatus:</strong> Indicates if the person smokes</li>
              <li><strong>cigsPerDay:</strong> Number of cigarettes a person smokes per day</li>
              <li><strong>BPMeds:</strong> Indicates if the person takes medications (1: yes, 2: no)</li>
              <li><strong>prevalentStroke:</strong> Person who had a stroke (1: yes, 0: no)</li>
              <li><strong>prevalentHyp:</strong> Person who has hypertension</li>
              <li><strong>diabetes:</strong> Person who has diabetes</li>
              <li><strong>totChol:</strong> Person's total cholesterol level</li>
              <li><strong>sysBP:</strong> Person's systolic blood pressure</li>
              <li><strong>diaBP:</strong> Person's diastolic blood pressure</li>
              <li><strong>BMI:</strong> Body mass index</li>
              <li><strong>heartRate:</strong> Person's resting heart rate</li>
              <li><strong>glucose:</strong> Person's blood glucose level</li>
              <li><strong>CHDRisk:</strong> Indicates if the person is at risk of heart disease</li>
            </ul>
          </div>
        </div>

        <div class="dataset-card">
          <h3>Dataset 2: HEART_2020_CLEANED</h3>
          <p class="dataset-size"><strong>Tamaño:</strong> 319,795 filas × 18 columnas</p>
          <div class="variables-list-compact">
            <ul>
              <li><strong>HeartDisease:</strong> Indicates if the person is at risk of heart disease</li>
              <li><strong>BMI:</strong> Body mass index</li>
              <li><strong>Smoking:</strong> Person who smokes</li>
              <li><strong>AlcoholDrinking:</strong> Person who drinks a lot of alcohol (men +14 drinks per week, women +7 drinks per week)</li>
              <li><strong>Stroke:</strong> Person who suffered a stroke</li>
              <li><strong>PhysicalHealth:</strong> How many of the last 30 days the person exercised</li>
              <li><strong>MentalHealth:</strong> How many of the last 30 days the person was not mentally well</li>
              <li><strong>DiffWalking:</strong> Person who has difficulty walking or climbing stairs</li>
              <li><strong>Sex:</strong> Female or male sex</li>
              <li><strong>AgeCategory:</strong> Age category</li>
              <li><strong>Race:</strong> Imputed ethnicity value</li>
              <li><strong>Diabetic:</strong> Person who was informed they have diabetes</li>
              <li><strong>PhysicalActivity:</strong> Adult who reported having performed physical activity during the last 30 days outside their usual work</li>
              <li><strong>GenHealth:</strong> Genetics</li>
              <li><strong>SleepTime:</strong> Hours of sleep</li>
              <li><strong>Asthma:</strong> Person who had asthma</li>
              <li><strong>KidneyDisease:</strong> Person who had kidney disease, excluding incontinence</li>
              <li><strong>SkinCancer:</strong> Person who had skin cancer</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="dataset-example">
        <h3>Dataset Examples</h3>
        <div class="dataset-tables">
          <div class="dataset-table-item">
            <h4>Dataset 1 - HEARTDISEASE (Primeras filas)</h4>
            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>sex</th>
                    <th>age</th>
                    <th>education</th>
                    <th>smokingStatus</th>
                    <th>cigsPerDay</th>
                    <th>totChol</th>
                    <th>sysBP</th>
                    <th>BMI</th>
                    <th>CHDRisk</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>male</td>
                    <td>39</td>
                    <td>4</td>
                    <td>no</td>
                    <td>0</td>
                    <td>195</td>
                    <td>106.0</td>
                    <td>26.97</td>
                    <td>no</td>
                  </tr>
                  <tr>
                    <td>female</td>
                    <td>46</td>
                    <td>2</td>
                    <td>no</td>
                    <td>0</td>
                    <td>250</td>
                    <td>121.0</td>
                    <td>28.73</td>
                    <td>no</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <div class="dataset-table-item">
            <h4>Dataset 2 - HEART_2020_CLEANED (Primeras filas)</h4>
            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>HeartDisease</th>
                    <th>BMI</th>
                    <th>Smoking</th>
                    <th>AlcoholDrinking</th>
                    <th>Stroke</th>
                    <th>Sex</th>
                    <th>AgeCategory</th>
                    <th>PhysicalActivity</th>
                    <th>GenHealth</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>No</td>
                    <td>16.60</td>
                    <td>Yes</td>
                    <td>No</td>
                    <td>No</td>
                    <td>Female</td>
                    <td>55-59</td>
                    <td>Yes</td>
                    <td>Very good</td>
                  </tr>
                  <tr>
                    <td>No</td>
                    <td>20.34</td>
                    <td>No</td>
                    <td>No</td>
                    <td>Yes</td>
                    <td>Female</td>
                    <td>80 or older</td>
                    <td>Yes</td>
                    <td>Very good</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="data-wrangling-section">
      <h2>2. Data Wrangling - Dataset Concatenation</h2>
      <p class="section-description">Both datasets were concatenated to obtain a more complete unified dataset. This process generates some additional transformations in the data and creates null values in columns that are not common between both datasets.</p>
      
      <div class="merged-dataset">
        <h3>Unified Dataset</h3>
        <p class="dataset-size"><strong>Final size:</strong> 323,469 rows × 20 columns</p>
        <div class="table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>sex</th>
                <th>age</th>
                <th>Smoking</th>
                <th>diabetes</th>
                <th>HeartDisease</th>
                <th>BMI</th>
                <th>totChol</th>
                <th>MentalHealth</th>
                <th>AgeCategory</th>
                <th>Race</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>male</td>
                <td>39.0</td>
                <td>no</td>
                <td>no</td>
                <td>NaN</td>
                <td>26.97</td>
                <td>195.0</td>
                <td>NaN</td>
                <td>NaN</td>
                <td>NaN</td>
              </tr>
              <tr>
                <td>female</td>
                <td>46.0</td>
                <td>no</td>
                <td>no</td>
                <td>NaN</td>
                <td>28.73</td>
                <td>250.0</td>
                <td>NaN</td>
                <td>NaN</td>
                <td>NaN</td>
              </tr>
            </tbody>
          </table>
        </div>
        <p class="note">Note: NaN values appear in columns that only exist in one of the original datasets.</p>
      </div>

      <div class="histograms-section">
        <h3>Histogram Analysis</h3>
        <p>After concatenation, variable histograms were analyzed to understand their distributions and detect possible data problems.</p>
        <div class="analysis-image">
          <img src="{{ site.baseurl }}/projects/heart-disease-data/histogramas.png" alt="Histogramas de variables" />
        </div>
      </div>
    </div>

    <div class="preprocessing-section">
      <h2>3. Data Processing</h2>
      
      <div class="preprocessing-step">
        <h3>3.1 Missing Value Treatment</h3>
        <p>Different imputation strategies were applied according to variable type and distribution:</p>
        <div class="imputation-strategies">
          <div class="strategy-card">
            <h4>Normal Variables</h4>
            <p>Missing data is replaced with the <strong>mean</strong></p>
          </div>
          <div class="strategy-card">
            <h4>Non-Normal Variables</h4>
            <p>Missing data is replaced with the <strong>median</strong></p>
          </div>
          <div class="strategy-card">
            <h4>Categorical Variables</h4>
            <p>Missing data is replaced with the <strong>mode</strong></p>
          </div>
        </div>
      </div>

      <div class="preprocessing-step">
        <h3>3.2 Categorical Variable Encoding</h3>
        <p><strong>LabelEncoder</strong> from scikit-learn was used to convert categorical variables into numeric values.</p>
        <div class="encoding-example">
          <div class="encoding-table">
            <h4>Before Encoding</h4>
            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>sex</th>
                    <th>Smoking</th>
                    <th>diabetes</th>
                    <th>HeartDisease</th>
                    <th>AlcoholDrinking</th>
                    <th>DiffWalking</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>male</td>
                    <td>no</td>
                    <td>no</td>
                    <td>no</td>
                    <td>No</td>
                    <td>No</td>
                  </tr>
                  <tr>
                    <td>female</td>
                    <td>no</td>
                    <td>no</td>
                    <td>no</td>
                    <td>No</td>
                    <td>No</td>
                  </tr>
                  <tr>
                    <td>male</td>
                    <td>yes</td>
                    <td>no</td>
                    <td>yes</td>
                    <td>No</td>
                    <td>No</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <div class="encoding-table">
            <h4>After Encoding</h4>
            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>sex</th>
                    <th>Smoking</th>
                    <th>diabetes</th>
                    <th>HeartDisease</th>
                    <th>AlcoholDrinking</th>
                    <th>DiffWalking</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>1</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                  </tr>
                  <tr>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                  </tr>
                  <tr>
                    <td>1</td>
                    <td>1</td>
                    <td>0</td>
                    <td>1</td>
                    <td>0</td>
                    <td>0</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <div class="preprocessing-step">
        <h3>3.3 Variable Scaling</h3>
        <p>Different scaling techniques were applied according to variable distribution:</p>
        <div class="scaling-strategies">
          <div class="strategy-card">
            <h4>Standard Scaler</h4>
            <p>For <strong>normal variables</strong>. Normalizes data by subtracting the mean and dividing by the standard deviation.</p>
            <div class="formula">
              <p>z = (x - μ) / σ</p>
            </div>
          </div>
          <div class="strategy-card">
            <h4>Robust Scaler</h4>
            <p>For <strong>non-normal variables</strong>. Uses the median and IQR, being more robust to outliers.</p>
            <div class="formula">
              <p>x_scaled = (x - median) / IQR</p>
            </div>
          </div>
        </div>
      </div>

      <div class="preprocessing-step">
        <h3>3.4 Outlier Treatment</h3>
        <p>Atypical values were identified and treated. For normal variables, outliers were replaced with the mean using the Z-Score method.</p>
        <div class="outliers-visualization">
          <h4>Visual Example - SleepTime Variable</h4>
          <div class="boxplot-comparison">
            <div class="boxplot-item">
              <h5>With Outliers</h5>
              <img src="{{ site.baseurl }}/projects/heart-disease-data/outliers.png" alt="Variables with outliers" />
            </div>
            <div class="boxplot-item">
              <h5>Without Outliers</h5>
              <img src="{{ site.baseurl }}/projects/heart-disease-data/sinOutliers.png" alt="Variables without outliers" />
            </div>
          </div>
        </div>
      </div>

      <div class="preprocessing-step">
        <h3>3.5 Correlation Analysis</h3>
        <p>The correlation map was analyzed to identify highly correlated variables and eliminate dependencies, avoiding multicollinearity in the models.</p>
        <div class="correlation-map">
          <img src="{{ site.baseurl }}/projects/heart-disease-data/correlaciones.png" alt="Correlation map" class="correlation-image" />
        </div>
        <p class="correlation-note">Variables with high correlation were eliminated to avoid the model having redundant information.</p>
      </div>
    </div>

    <div class="eda-section">
      <h2>4. Exploratory Data Analysis (EDA)</h2>
      <p class="section-description">Exploratory analyses were performed to answer key questions about cardiovascular risk factors.</p>
      
      <div class="eda-questions">
        <div class="eda-question">
          <h3>Does age influence the possibility of developing heart disease?</h3>
          <div class="eda-image eda-image-small eda-image-compact">
            <img src="{{ site.baseurl }}/projects/heart-disease-data/age.png" alt="Age influence on heart disease" />
          </div>
        </div>
        
        <div class="eda-question">
          <h3>Is a person who smokes more prone to heart disease?</h3>
          <div class="eda-image eda-image-small eda-image-compact">
            <img src="{{ site.baseurl }}/projects/heart-disease-data/fuma.png" alt="Smoking influence on heart disease" />
          </div>
        </div>
      </div>
    </div>

    <div class="balancing-section">
      <h2>5. Target Variable Balancing</h2>
      <p class="section-description">The dataset had a significant imbalance in the target variable. <strong>Oversampling</strong> technique was applied to create new synthetic samples of the minority class and balance the classes.</p>
      
      <div class="balancing-visualization">
        <div class="balance-item">
          <h3>Before Balancing</h3>
          <img src="{{ site.baseurl }}/projects/heart-disease-data/desbalance.png" alt="Class imbalance" />
        </div>
        <div class="balance-item">
          <h3>After Balancing</h3>
          <img src="{{ site.baseurl }}/projects/heart-disease-data/balanceo.png" alt="Class balancing" />
        </div>
      </div>
    </div>

    <div class="pca-section">
      <h2>6. Principal Component Analysis (PCA)</h2>
      <p class="section-description">PCA (Principal Component Analysis) was applied to reduce dataset dimensionality and eliminate redundancies, maintaining as much information as possible with fewer variables.</p>
      
      <div class="pca-explanation">
        <h3>What is PCA?</h3>
        <p>PCA is a dimensionality reduction technique that transforms original variables into principal components (new uncorrelated variables) that capture the maximum possible variance. This helps to:</p>
        <ul>
          <li>Reduce the number of features while maintaining relevant information</li>
          <li>Eliminate redundancies and correlations between variables</li>
          <li>Improve model performance when working with fewer dimensions</li>
        </ul>
        
        <h3>Cumulative Explained Variance vs Components</h3>
        <p>Cumulative explained variance shows how much information from the original data is preserved when using a certain number of principal components. A high value indicates that most of the information is being preserved.</p>
      </div>

      <div class="pca-visualization">
        <img src="{{ site.baseurl }}/projects/heart-disease-data/Varianza.png" alt="Cumulative explained variance" class="pca-image-small" />
        <p class="pca-note">Using the elbow method, it is observed that from component 15 onwards, the variance increases minimally. Therefore, 15 principal components were selected to apply PCA.</p>
      </div>
    </div>

    <div class="models-section">
      <h2>7. Model Training</h2>
      <p class="section-description">4 different machine learning algorithms were trained and compared, applying advanced validation and optimization techniques for each.</p>
      
      <div class="validation-techniques">
        <h3>Validation and Optimization Techniques Used</h3>
        <div class="techniques-grid">
          <div class="technique-card">
            <h4>Simple Validation</h4>
            <p>Division of the dataset into training and test sets to evaluate the model's initial performance.</p>
          </div>
          <div class="technique-card">
            <h4>Cross Validation</h4>
            <p>Strategy that divides data into k subsets (folds) and trains the model k times, each time using a different fold as the test set. This helps avoid overfitting and provides a more robust performance estimate.</p>
          </div>
          <div class="technique-card">
            <h4>HalvingGridSearchCV</h4>
            <p>Hyperparameter optimization that combines GridSearch with a "halving" strategy (progressive reduction). It starts by evaluating many parameters with few resources and gradually focuses resources on the most promising combinations, being more efficient than traditional GridSearch.</p>
          </div>
        </div>
      </div>

      <div class="models-comparison">
        <h3>Model Comparison</h3>
        <div class="table-container">
          <table class="data-table comparison-table">
            <thead>
              <tr>
                <th>Metric</th>
                <th>Decision Tree</th>
                <th>Random Forest</th>
                <th>Logistic Regression</th>
                <th>XGBoost</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Accuracy</strong></td>
                <td>0.6927</td>
                <td>0.6933</td>
                <td>0.7406</td>
                <td>0.6933</td>
              </tr>
              <tr>
                <td><strong>Precision</strong></td>
                <td>0.9101</td>
                <td>0.9102</td>
                <td>0.9072</td>
                <td>0.9102</td>
              </tr>
              <tr>
                <td><strong>Recall</strong></td>
                <td>0.6927</td>
                <td>0.6933</td>
                <td>0.7406</td>
                <td>0.6933</td>
              </tr>
              <tr>
                <td><strong>F1 Score</strong></td>
                <td>0.7604</td>
                <td>0.7609</td>
                <td>0.7960</td>
                <td>0.7609</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="conclusion-box">
          <h4>Conclusion</h4>
          <p>Comparing all models, it is observed that precision is quite high, reaching 90%, with DecisionTree and XGBoosting even reaching 91%. However, in terms of recall, accuracy, and F1 Score, RandomForest and the Logistic Regression model show more solid metrics. Although the differences are minimal, the final choice leans towards the <strong>Logistic Regression</strong> model, which slightly outperforms RandomForest in overall performance.</p>
          <div class="final-model-badge">
            <i class="fas fa-trophy"></i>
            <span>Final Model: Logistic Regression</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
